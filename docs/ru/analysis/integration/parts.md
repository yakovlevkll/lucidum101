## Интегрирование по частям

Метод интегрирования по частям -- это один из основных приёмов интегрального исчисления наряду с взятием простейших интегралов и интегрировании с заменой переменной.

Какую задачу решает метод интегрирования по частям? Метод интегрирования по частям решает очень важную задачу, он позволяет интегрировать некоторые функции, отсутствующие в таблице, произведение функций, а в ряде случаев -- и частное.
В интегрировании нет удобной формулы наподобие $(uv)' = u'v + v'u$ для вычисления производной произведения. Зато есть такая -- формула интегрирования по частям собственной персоной

$$\int udv = uv - \int vdu$$

По частям берутся интегралы следующих видов:

1. $\int \ln(x)dx$, $\int (x^2 + 3)\ln(x)dx$, $\int x\ln^2(x)dx$ - логарифм или логарифм, умноженный на какой-нибудь полином.

2. $\int xe^x dx$, $\int (x^2 -2x +5)e^{-2x} dx$ -- экспоненциальная функция, умноженная на какой-нибудь полином. Сюда же можно отнести интегралы вроде $\int 4^x x dx$ -- показательная функция, умноженная на полином, но в подавляющем большинстве случаев под интегралом находится $е$.

3. $\int x \cos 6x dx$, $\int (x^2 + 3x) \sin 2x dx$, $\int x \tan^2 x dx$ -- тригонометрические функции, умноженные на какой-нибудь полином.

4. $\int \arcsin x dx$, $\int x^2 \arctan x dx$ -- обратные тригонометрические функции («арки»), умноженные на какой-нибудь полином.

Также по частям берутся некоторые дроби, соответствующие Заданиеы мы тоже подробно рассмотрим.

### Интегралы от логарифмов

**Пример 1.** Найти неопределенный интеграл.

$$\int \ln{x} dx$$

Воспользуемся формулой интегрирования по частям

$$\int udv = uv - \int vdu$$

Формула применяется слева направо. Смотрим на левую часть: $\int udv$. Очевидно, что в нашем Заданиее (и во всех остальных, которые мы рассмотрим) что-то нужно обозначить за $u$, а что-то -- за $dv$.

В интегралах рассматриваемого типа за $u$ всегда принимается логарифм.

Оформление решения реализуется следующим образом:

$u = \ln x$
$dv = dx$

То есть за $u$ мы обозначили логарифм, а за $dv$ -- оставшуюся часть подынтегрального выражения.

Следующий этап -- находим дифференциал $du$:

$u = \ln{x} \Rightarrow du = (\ln x)'dx = \dfrac{1}{x} \, dx$
$dv = dx$

Теперь находим функцию $v$. Для того чтобы её найти, необходимо проинтегрировать правую часть нижнего равенства $dv = dx$:

$u = \ln{x} \Rightarrow du = (\ln x)'dx = \dfrac{1}{x} \, dx$
$dv = dx \Rightarrow v = \int dx = x$

Теперь открываем наше решение и записываем правую часть формулы ($uv - \int vdu$)

$$\int \ln{x} dx = x \ln{x} - \int x * \dfrac{1}{x} \, dx = x \ln{x} - \int dx = x \ln{x} - x + C$$

Где $C = const$.

В произведении $uv$ я сразу переставил местами $u$ и $v$, так как множитель $x$ принято записывать перед логарифмом.

Как видно, применение формулы интегрирования по частям свело наше решение к двум простым интегралам.

Обратите внимание, что в ряде случаев сразу после применения формулы, под оставшимся интегралом обязательно проводится упрощение -- в рассматриваемом Заданиее мы сократили подынтегральное выражение на $x$.

Выполним проверку. Для этого нужно взять производную от ответа:

$$(x \ln{x} - x + C)' = (x \ln x)' - (x)' + (C)' = (x)' \ln{x} + x(\ln x)' - 1 + 0 =$$
$$= 1 * \ln{x} + x * \dfrac{1}{x} - 1 = \ln{x} + 1 - 1 = \ln x$$

Получена исходная подынтегральная функция, значит, интеграл решён правильно.

В ходе проверки мы использовали правило дифференцирования произведения $(uv)' = u'v + v'u$, и это не случайно. Формула интегрирования по частям и формула нахождения производной от произведения -- это два взаимно обратных правила.

**Пример 2.** Найти неопределенный интеграл.

$$\int_{}^{}{x \ln^2{x} dx}$$

Подынтегральная функция представляет собой произведение логарифма на полином.

Как уже говорилось, за $u$ необходимо обозначить логарифм (то, что он в степени, значения не имеет). За $dv$ обозначаем оставшуюся часть подынтегрального выражения.

Записываем в столбик

$u = \ln^2{x}$
$dv = xdx$

Сначала находим дифференциал
$u = \ln^2{x} \Rightarrow du = (\ln^2{x})'dx = 2\ln{x}( \ln{x})'dx = \dfrac{2\ln{x}}{x} dx$

Здесь использовано правило дифференцирования сложной функции

$$(u(v))' = u'(v) * v'$$

Теперь находим функцию $v$, для этого интегрируем правую часть второго равенства

$dv = xdx \Rightarrow v = \int{xdx} = \dfrac{x^2}{2}$

Для интегрирования мы применили простейшую табличную формулу

$$\int{x^{n} dx} = \dfrac{x^{n + 1}}{n + 1} + C$$

Теперь всё готово для применения формулы

$$\int{x \ln^2{x} dx} = \dfrac{x^{2} \ln{x}}{2} - \int{\dfrac{x^{2}}{2} * \dfrac{2\ln{x}}{x} dx} = \dfrac{x^{2} \ln{x}}{2} - \int{x\ln{x} dx}$$

Под интегралом у нас снова полином на логарифм. Поэтому решение опять прерывается и правило интегрирования по частям применяется второй раз. Не забываем, что за $u$ в похожих ситуациях всегда обозначается логарифм.

$u = \ln{x} \Rightarrow du = \dfrac{1}{x} dx$

$dv = xdx \Rightarrow v = \dfrac{x^{2}}{2}$

Хорошо бы, если к данному моменту простейшие интегралы и производные Вы умели находить устно.

Возвращаемся к основному примеру и следим за знаками

$$\dfrac{x^{2} \ln{x}}{2} - \int {x\ln{x} dx} = \dfrac{x^{2} \ln{x}}{2} - ( \dfrac{x^{2}\ln{x}}{2} - \int {\dfrac{x^{2}}{2} * \dfrac{1}{x} dx} ) = \dfrac{x^{2} \ln{x}}{2} - \dfrac{x^{2}\ln{x}}{2} + \dfrac{1}{2}\int \text{xdx} =$$

$$= \dfrac{x^{2} \ln{x}}{2} - \dfrac{x^{2}\ln{x}}{2} + \dfrac{1}{2} * \dfrac{x^{2}}{2} + C = \dfrac{x^{2}}{2}( \ln{x} - \ln{x} + \dfrac{1}{2} ) + C$$

Необходимость дважды (а то и трижды) применять правило интегрирования по частям возникает не так уж и редко.

::: task

1. Найти неопределенный интеграл.
   $$\int{\dfrac{\ln{x}}{x} dx}$$
   Это задание решается методом замены переменной (или подведением под знак дифференциала). Но можно попробовать взять его по частям, получится забавная вещь.

2. Найти неопределенный интеграл.
   $$\int{\dfrac{\ln{x}}{x^{2}} dx}$$
   А вот этот интеграл интегрируется по частям (обещанная дробь).

:::

Подынтегральные функции в заданиях похожи, а вот методы решения -- разные! В этом-то и состоит основная трудность освоения интегралов -- если неправильно подобрать метод решения интеграла, то возиться с ним можно часами, как с самой настоящей головоломкой. Поэтому чем больше вы прорешаете различных интегралов, тем легче они будут даваться.

### Интегралы от экспоненты, умноженной на полином

Общее правило: за $u$ всегда обозначается полином

**Пример 1.** Найти неопределенный интеграл.

$$\int {( x - 2 )e^{2x} dx}$$

Используя знакомый алгоритм, интегрируем по частям

$u = x - 2 \Rightarrow du = ( x - 2 )'dx = x$

$dv = e^{2x}dx \Rightarrow v = \int {e^{2x} dx} = \dfrac{e^{2x}}{2}$

$$\int {( x - 2 )e^{2x} dx} = \dfrac{( x - 2 )e^{2x}}{2} - \dfrac{1}{2}\int {e^{2x} dx} = \dfrac{( x - 2 )e^{2x}}{2} - \dfrac{1}{2} * \dfrac{1}{2}e^{2x} + C = \dfrac{e^{2x}}{2}( x - 2 - \dfrac{1}{2} ) = \dfrac{e^{2x}}{2}( x - 1\dfrac{1}{2} )$$

::: task

1. Найти неопределенный интеграл.
   $$\int {( x^{2} + x )e^{- x} dx}$$
   Данный интеграл дважды интегрируется по частям. Особое внимание следует обратить на знаки, в них легко запутаться. Также помним, что $e^{-x}$ -- сложная функция.

:::

### Интегралы от тригонометрических функций, умноженных на полином

Общее правило: за $u$ всегда обозначается полином

**Пример 1.** Найти неопределенный интеграл.

$$\int {x\cos{6x} dx}$$

Интегрируем по частям

$u = x \Rightarrow du = dx$

$dv = \cos{6x}dx \Rightarrow v = \int {\cos{6x} dx} = \dfrac{1}{6}\sin{6x}$

$$\int {x\cos{6x} dx} = \dfrac{1}{6}x\sin{6x} - \dfrac{1}{6}\int {\sin{6x} dx} = \dfrac{1}{6}x\sin{6x} - \dfrac{1}{6} * ( - \dfrac{1}{6}x\cos{6x} ) + C =$$

$$= \dfrac{1}{6}x\sin{6x} + \dfrac{1}{36}x\cos{6x} + C$$

**Пример 2.** Найти неопределенный интеграл

$$\int {\dfrac{x}{ \sin^2{x}} dx}$$

Еще один интеграл с дробью. Как и в двух предыдущих заданиях, за $u$ обозначается полином.

Интегрируем по частям

$u = x \Rightarrow du = dx$

$dv = \dfrac{1}{ \sin^2{x}}dx \Rightarrow v = \int {\dfrac{1}{ \sin^2{x}} dx} = - \cot{x}$

$$\int {\dfrac{x}{ \sin^2{x}} dx} = - x\cot{x} + \int {\cot{x} dx} = - x\cot{x} + \int {\dfrac{\cos x}{\sin x} dx} = - x\cot{x} + \int \dfrac{d(\sin{x)}}{\sin x} =$$

$$= - x\cot{x} + \sin^2\left| \sin x \right| + C$$

::: task

1. Найти неопределенный интеграл
   $$\int {(x - 6)\sin\dfrac{x}{2} dx}$$

2. Найти неопределенный интеграл
   $$\int {x\sin x\cos x dx}$$
   Подсказка: перед использованием метода интегрирования по частям следует применить некоторую тригонометрическую формулу, которая превращает произведение двух тригонометрических функций в одну функцию. Формулу также можно использовать и в ходе применения метода интегрирования по частям, кому как удобнее.

:::

### Интегралы от обратных тригонометрических функций

Общее правило: за $u$ всегда обозначается обратная тригонометрическая функция.

Напоминаю, что к обратным тригонометрическим функциям относятся арксинус, арккосинус, арктангенс и арккотангенс. Для краткости записи я буду называть их «арками»

**Пример 1.** Найти неопределенный интеграл.

$$\int {\operatorname{atan}{2x} dx}$$

Интегрируем по частям

$u = \operatorname{atan}{2x} \Rightarrow du = ( \operatorname{atan}{2x} )'dx = \dfrac{1}{1 + ( 2x )^{2}} * ( 2x )'dx = \dfrac{2}{1 + 4x^{2}} dx$

$dv = dx \Rightarrow v = x$

$$\int {\operatorname{atan}{2x} dx} = x\operatorname{atan}{2x} - \int {\dfrac{2x}{1 + 4x^{2}} dx} = x\operatorname{atan}{2x} - \dfrac{1}{4}\int \dfrac{d( 1 + 4x^{2} )}{1 + 4x^{2}} =$$

$$x\operatorname{atan}{2x} - \dfrac{1}{4}\sin^2( 1 + 4x^{2} ) + C$$

Интеграл найден методом подведения функции под знак дифференциала, можно использовать и метод замены в «классическом» виде.

Таким образом, помимо «чистого» интегрирования по частям нередко требуется применять и другие методы, приёмы решения.

::: task

1. Найти неопределенный интеграл.
   $$\int {\operatorname{asin}{3x} dx}$$

2. Найти неопределенный интеграл.
   $$\int {x\operatorname{atan}x dx}$$
   Заключительное задание для желающих лучше разобраться в методе интегрирования по частям.

:::
